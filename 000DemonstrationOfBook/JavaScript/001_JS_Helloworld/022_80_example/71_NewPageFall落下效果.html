<!DOCTYPE html>
<html>
<head>
	<title>窗口从上掉下来 FIXME</title>
	<meta charset="utf-8">
</head>
<body bgcolor="#fef4d9">
	<center>
		<span class="STYLE1">窗口从上掉下来</span>
	</center><br>
	<center>
	<table style="#00FFFF border=5 border-color: green">
		<tr>
			<td align="middle">
				<span class="STYLE2">效果显示</span>
				<div id="dropin" style="left: 300px; visibility: hidden; width: 400px; position: absolute;top: 250px; height: 200px; background-color: #f5f5f5">
					<div align="right">
						<a href="javascript:dismissbox()">[关闭窗口]</a>
						<br>
						<p>
						如果想法改变，态度就会改变；如果习惯改变，人格就会改变；如果命运改变，人生就会改变。</p>
					</div>
				</div>
			</td>
		</tr>
	</table>
	</center>
	<script type="text/javascript">
		var ie=document.all
		var dom=document.getElementById
		var ns4=document.layers
		var bouncelimit=32 //(must be divisible by 8)
		var curtop
		var direction="up"
		var boxheight=''
		function initbox(){
		if (!dom&&!ie&&!ns4)
		return
		crossobj=(dom)?document.getElementById("dropin").style : ie? document.all.dropin : document.dropin
		scroll_top=(ie)? document.body.scrollTop : window.pageYOffset
		crossobj.top=scroll_top-250
		crossobj.visibility=(dom||ie)? "visible" : "show"
		dropstart=setInterval("dropin()",50)
		}
		function dropin(){
		scroll_top=(ie)? document.body.scrollTop : window.pageYOffset
		if (parseInt(crossobj.top)<100+scroll_top)
		crossobj.top=parseInt(crossobj.top)+40
		else{
		clearInterval(dropstart)
		bouncestart=setInterval("bouncein()",50)
		}
		}
		function bouncein(){
		crossobj.top=parseInt(crossobj.top)-bouncelimit
		if (bouncelimit<0)
		bouncelimit+=8
		bouncelimit=bouncelimit*-1
		if (bouncelimit==0){
		clearInterval(bouncestart)
		}
		}
		function dismissbox(){
		if (window.bouncestart) clearInterval(bouncestart)
		crossobj.visibility="hidden"
		}
		window.onload=initbox
	</script>

</body>
</html>